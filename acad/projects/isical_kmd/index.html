<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c65{margin-left:0pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:16.4pt}.c25{margin-left:0.1pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:107.9pt}.c55{color:#008000;font-weight:700;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c72{margin-left:0.1pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:34.4pt}.c3{color:#ba2121;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c79{margin-left:2.6pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:146.1pt}.c49{margin-left:0.4pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:-0.3pt}.c70{margin-left:2.4pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:205.1pt}.c32{margin-left:0.4pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.999618411064148;text-align:left;margin-right:12.8pt}.c42{margin-left:0pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:29.9pt}.c1{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c71{margin-left:0.4pt;padding-top:0pt;text-indent:0pt;padding-bottom:0pt;line-height:1.416171908378601;text-align:left;margin-right:33.1pt}.c10{color:#3d7a7a;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:italic}.c63{margin-left:2.5pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9996113777160645;text-align:left;margin-right:99pt}.c11{margin-left:0.4pt;padding-top:1.2pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:107.6pt}.c53{margin-left:2.9pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:191.9pt}.c48{margin-left:2.5pt;padding-top:1.2pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:124.7pt}.c47{margin-left:0pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:112.7pt}.c15{margin-left:0.1pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9996744990348816;text-align:left;margin-right:76.8pt}.c82{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:9.6pt;font-family:"Arial";font-style:normal}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:5pt;font-family:"Arial";font-style:normal}.c5{color:#0000ff;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c46{margin-left:0pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:40.6pt}.c74{margin-left:0.1pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:33.5pt}.c16{margin-left:2.5pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:190.7pt}.c17{margin-left:0.4pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:38.2pt}.c45{margin-left:2.5pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9996132254600525;text-align:left;margin-right:151.3pt}.c58{margin-left:0.1pt;padding-top:0.3pt;text-indent:0pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:96pt}.c60{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:10pt;font-family:"Arial";font-style:normal}.c69{padding-top:18pt;padding-bottom:0pt;line-height:1.0;text-align:right;margin-right:255.1pt;height:11pt}.c75{margin-left:0.1pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:99.5pt}.c73{margin-left:0pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:3.3pt}.c56{margin-left:2.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:110.6pt}.c52{padding-top:18pt;padding-bottom:0pt;line-height:1.0;text-align:right;margin-right:257.8pt;height:11pt}.c24{padding-top:18pt;padding-bottom:0pt;line-height:1.0;text-align:right;margin-right:255.2pt;height:11pt}.c59{margin-left:0pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:80.1pt}.c39{margin-left:0pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:34.4pt}.c27{margin-left:0.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:80.1pt}.c77{margin-left:0.1pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995903372764587;text-align:left;margin-right:64.9pt}.c22{margin-left:0.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9996182322502136;text-align:left;margin-right:33.1pt}.c33{margin-left:2.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9996744990348816;text-align:left;margin-right:181.7pt}.c40{padding-top:18pt;padding-bottom:0pt;line-height:1.0;text-align:right;margin-right:256pt;height:11pt}.c81{padding-top:16.7pt;padding-bottom:0pt;line-height:1.0;text-align:right;margin-right:257.9pt;height:11pt}.c80{margin-left:0.1pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:3.9pt}.c62{margin-left:0.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995929002761841;text-align:left;margin-right:4.8pt}.c50{margin-left:0.1pt;padding-top:0.3pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:39.5pt}.c35{margin-left:2.5pt;padding-top:1.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c76{margin-left:5.4pt;padding-top:13.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c9{margin-left:0.1pt;padding-top:6.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c36{margin-left:0.4pt;padding-top:6.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c18{margin-left:2.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c20{margin-left:0.1pt;padding-top:5.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c30{margin-left:2.9pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c29{margin-left:4.9pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c43{margin-left:2.4pt;padding-top:5.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c21{margin-left:2.6pt;padding-top:6.1pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c41{margin-left:0.4pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c31{margin-left:18.8pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c26{margin-left:0.4pt;padding-top:1.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c14{margin-left:2.5pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c34{margin-left:2.6pt;padding-top:5.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c23{margin-left:0pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c37{margin-left:0.4pt;padding-top:5.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c28{margin-left:5pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c4{margin-left:0pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c19{margin-left:0pt;padding-top:5.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c6{margin-left:0.4pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c13{margin-left:0.1pt;padding-top:1.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c7{margin-left:2.6pt;padding-top:1.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c57{margin-left:0pt;padding-top:1.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c64{margin-left:0.1pt;padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c51{padding-top:1.2pt;padding-bottom:0pt;line-height:0.9995900392532349;text-align:left;margin-right:59.8pt}.c8{margin-left:0.1pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c12{margin-left:2.6pt;padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c61{padding-top:1.2pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c44{padding-top:0.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c78{padding-top:0pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c66{padding-top:5.3pt;padding-bottom:0pt;line-height:1.0;text-align:left}.c38{background-color:#ffffff;max-width:526.2pt;padding:63.2pt 30.4pt 19.8pt 38.4pt}.c68{margin-left:5pt}.c67{margin-left:2.5pt}.c54{margin-left:5.1pt}.title{padding-top:24pt;color:#000000;font-weight:700;font-size:36pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:18pt;color:#666666;font-size:24pt;padding-bottom:4pt;font-family:"Georgia";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:24pt;color:#000000;font-weight:700;font-size:24pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-weight:700;font-size:18pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:14pt;color:#000000;font-weight:700;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:12pt;color:#000000;font-weight:700;font-size:12pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:11pt;color:#000000;font-weight:700;font-size:11pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:10pt;color:#000000;font-weight:700;font-size:10pt;padding-bottom:2pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}</style></head>

<body class="c38 doc-content">
<p class="c31"><span class="c60">VII. A</span><span class="c82">PPENDIX </span></p><p class="c76"><span class="c0">1 </span><span class="c2">Number of Delays Vs Airlines AND Number of Delays Vs Day in Week</span><span class="c1">: </span></p><p class="c66 c68"><span class="c0">2 </span></p><p class="c61 c68"><span class="c0">3 </span><span class="c2">a </span><span class="c1">= </span><span class="c5">read.csv</span><span class="c2">(</span><span class="c3">&quot;D:/Airlines.csv&quot;</span><span class="c2">, header </span><span class="c1">= </span><span class="c55">TRUE</span><span class="c2">) </span></p><p class="c29"><span class="c0">4 </span><span class="c5">library</span><span class="c2">(dplyr) </span></p><p class="c28"><span class="c0">5 </span><span class="c2">x </span><span class="c1">= </span><span class="c5">subset</span><span class="c2">(a, select </span><span class="c1">= -</span><span class="c2">id) </span></p><p class="c28"><span class="c0">6 </span><span class="c2">data </span><span class="c1">= </span><span class="c5">distinct</span><span class="c2">(x) </span></p><p class="c29"><span class="c0">7 </span><span class="c5">tail</span><span class="c2">(data,</span><span class="c1">5</span><span class="c2">) </span></p><p class="c44 c54"><span class="c0">8 </span><span class="c2">D </span><span class="c1">= </span><span class="c2">data</span><span class="c1">$</span><span class="c2">Delay </span></p><p class="c28"><span class="c0">9 </span><span class="c2">AL </span><span class="c1">= </span><span class="c2">data</span><span class="c1">$</span><span class="c2">Airline </span></p><p class="c30"><span class="c0">10 </span><span class="c2">a </span><span class="c1">= </span><span class="c5">unique</span><span class="c2">(AL) </span></p><p class="c53"><span class="c0">11 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">length</span><span class="c2">(a)) </span><span class="c10">#give the total number of airlines </span><span class="c0">12 </span><span class="c2">x</span><span class="c1">=0 </span></p><p class="c30"><span class="c0">13 </span><span class="c2">y</span><span class="c1">=0 </span></p><p class="c30"><span class="c0">14 </span><span class="c5">for</span><span class="c2">(j in </span><span class="c1">1:18</span><span class="c2">) </span></p><p class="c30"><span class="c0">15 </span><span class="c2">{ </span></p><p class="c30"><span class="c0">16 </span><span class="c2">count </span><span class="c1">=0 </span></p><p class="c30"><span class="c0">17 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:322765</span><span class="c2">) </span></p><p class="c30"><span class="c0">18 </span><span class="c2">{ </span></p><p class="c30"><span class="c0">19 </span><span class="c5">if</span><span class="c2">(AL[i]</span><span class="c1">==</span><span class="c2">a[j]) </span></p><p class="c14"><span class="c0">20 </span><span class="c2">count </span><span class="c1">= </span><span class="c2">count </span><span class="c1">+ </span><span class="c2">D[i] </span></p><p class="c14"><span class="c0">21 </span><span class="c2">} </span></p><p class="c14"><span class="c0">22 </span><span class="c2">x[j] </span><span class="c1">= </span><span class="c2">a[j] </span></p><p class="c14"><span class="c0">23 </span><span class="c2">y[j] </span><span class="c1">= </span><span class="c2">count </span></p><p class="c14"><span class="c0">24 </span><span class="c2">} </span></p><p class="c14"><span class="c0">25 </span><span class="c2">x </span><span class="c10">#Stores the names of airlines </span></p><p class="c63"><span class="c0">26 </span><span class="c2">y </span><span class="c10">#Stores the total number of delays of the corresponding airlines </span><span class="c0">27 </span><span class="c5">par</span><span class="c2">(bg </span><span class="c1">= </span><span class="c3">&quot;grey&quot;</span><span class="c2">) </span><span class="c10">#sets the background colour of the plot </span><span class="c0">28 </span><span class="c5">barplot</span><span class="c2">(y, names</span><span class="c1">=</span><span class="c2">x, col</span><span class="c1">=</span><span class="c3">&quot;dark violet&quot;</span><span class="c2">, xlab</span><span class="c1">=</span><span class="c3">&quot;Airlines&quot;</span><span class="c2">,ylab</span><span class="c1">=</span><span class="c3">&quot;Number of delays&quot;</span><span class="c2">) </span><span class="c0">29 </span><span class="c10">#Checking which airline has the most delays and least delays </span><span class="c0">30 </span><span class="c2">d</span><span class="c1">=0 </span></p><p class="c12"><span class="c0">31 </span><span class="c2">c1</span><span class="c1">=0 </span></p><p class="c12"><span class="c0">32 </span><span class="c2">dd </span><span class="c1">= </span><span class="c2">data</span><span class="c1">$</span><span class="c2">DayOfWeek </span></p><p class="c12"><span class="c0">33 </span><span class="c2">days </span><span class="c1">= </span><span class="c5">c</span><span class="c2">(</span><span class="c1">1</span><span class="c2">,</span><span class="c1">2</span><span class="c2">,</span><span class="c1">3</span><span class="c2">,</span><span class="c1">4</span><span class="c2">,</span><span class="c1">5</span><span class="c2">,</span><span class="c1">6</span><span class="c2">,</span><span class="c1">7</span><span class="c2">) </span></p><p class="c12"><span class="c0">34 </span><span class="c5">for</span><span class="c2">(j in </span><span class="c1">1:7</span><span class="c2">) </span></p><p class="c12"><span class="c0">35 </span><span class="c2">{ </span></p><p class="c12"><span class="c0">36 </span><span class="c2">count </span><span class="c1">= 0 </span></p><p class="c12"><span class="c0">37 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:322765</span><span class="c2">) </span></p><p class="c12"><span class="c0">38 </span><span class="c2">{ </span></p><p class="c12"><span class="c0">39 </span><span class="c5">if</span><span class="c2">(dd[i] </span><span class="c1">== </span><span class="c2">days[j]) </span></p><p class="c18"><span class="c0">40 </span><span class="c2">count </span><span class="c1">= </span><span class="c2">count </span><span class="c1">+ </span><span class="c2">D[i] </span></p><p class="c18"><span class="c0">41 </span><span class="c2">} </span></p><p class="c18"><span class="c0">42 </span><span class="c2">d[j] </span><span class="c1">= </span><span class="c2">days[j] </span></p><p class="c18"><span class="c0">43 </span><span class="c2">c1[j] </span><span class="c1">= </span><span class="c2">count </span></p><p class="c18"><span class="c0">44 </span><span class="c2">} </span></p><p class="c18"><span class="c0">45 </span><span class="c2">d </span><span class="c10">#Stores the days in week </span></p><p class="c70"><span class="c0">46 </span><span class="c2">c1 </span><span class="c10">#Stores the corresponding number of delays </span><span class="c0">47 </span><span class="c5">par</span><span class="c2">(bg</span><span class="c1">=</span><span class="c3">&quot;black&quot;</span><span class="c2">) </span></p><p class="c56"><span class="c0">48 </span><span class="c5">barplot</span><span class="c2">(c1,names</span><span class="c1">=</span><span class="c2">d,fg</span><span class="c1">=</span><span class="c3">&quot;blue&quot;</span><span class="c2">,col.axis</span><span class="c1">=</span><span class="c3">&quot;white&quot;</span><span class="c2">,col.lab</span><span class="c1">=</span><span class="c3">&quot;white&quot;</span><span class="c2">,density</span><span class="c1">=30</span><span class="c2">, </span><span class="c0">49 </span><span class="c2">col</span><span class="c1">=</span><span class="c3">&quot;yellow&quot;</span><span class="c2">,xlab</span><span class="c1">=</span><span class="c3">&quot;Day in week&quot;</span><span class="c2">,ylab</span><span class="c1">=</span><span class="c3">&quot;Number of delays&quot;</span><span class="c2">) </span><span class="c0">50 </span><span class="c10">#Checking on which day there are the most and least delays </span></p><p class="c66 c67"><span class="c0">51 </span></p><p class="c35"><span class="c0">52 </span><span class="c2">AIRLINE SPECIFIC</span><span class="c1">: </span></p><p class="c66 c67"><span class="c0">53 </span></p><p class="c35"><span class="c0">54 </span><span class="c5">install.packages</span><span class="c2">(</span><span class="c3">&quot;glmnet&quot;</span><span class="c2">) </span></p><p class="c14"><span class="c0">55 </span><span class="c5">install.packages</span><span class="c2">(</span><span class="c3">&quot;rlang&quot;</span><span class="c2">) </span></p><p class="c14"><span class="c0">56 </span><span class="c5">install.packages</span><span class="c2">(</span><span class="c3">&quot;caret&quot;</span><span class="c2">) </span></p><p class="c14"><span class="c0">57 </span><span class="c5">install.packages</span><span class="c2">(</span><span class="c3">&quot;dplyr&quot;</span><span class="c2">) </span></p><p class="c14"><span class="c0">58 </span><span class="c2">[a] </span></p><p class="c14"><span class="c0">59 </span><span class="c2">data </span><span class="c1">= </span><span class="c5">read.csv</span><span class="c2">(</span><span class="c3">&quot;D:/Airlines.csv&quot;</span><span class="c2">, header </span><span class="c1">= </span><span class="c55">TRUE</span><span class="c2">) </span></p><p class="c81"><span class="c2"></span></p><p class="c67 c78"><span class="c0">60 </span><span class="c2">a </span><span class="c1">&lt;- </span><span class="c5">subset</span><span class="c2">(data, select </span><span class="c1">= -</span><span class="c2">id) </span></p><p class="c16"><span class="c0">61 </span><span class="c5">head</span><span class="c2">(a, </span><span class="c1">10</span><span class="c2">) </span><span class="c10">#to display first 10 rows of the new data </span><span class="c0">62 </span><span class="c5">library</span><span class="c2">(dplyr) </span></p><p class="c14"><span class="c0">63 </span><span class="c5">options</span><span class="c2">(max.print</span><span class="c1">=10000000</span><span class="c2">) </span></p><p class="c45"><span class="c0">64 </span><span class="c2">x </span><span class="c1">= </span><span class="c5">distinct</span><span class="c2">(a) </span><span class="c10">#to remove the repetitions in the data </span><span class="c0">65 </span><span class="c5">tail</span><span class="c2">(x, </span><span class="c1">10</span><span class="c2">) </span><span class="c10">#to display the last 10 rows of the new data </span><span class="c0">66 </span><span class="c2">air </span><span class="c1">= </span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">Airline) </span><span class="c10">#to find out distinct airlines </span><span class="c0">67 </span><span class="c2">CO</span><span class="c1">=</span><span class="c2">x</span><span class="c1">%&gt;%</span><span class="c5">filter</span><span class="c2">(Airline</span><span class="c1">==</span><span class="c3">&quot;X&quot;</span><span class="c2">)</span><span class="c1">* </span><span class="c10">#to extract airline specific rows </span><span class="c0">68 </span><span class="c2">[b] </span></p><p class="c14"><span class="c0">69 </span><span class="c2">af</span><span class="c1">=</span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">AirportFrom) </span></p><p class="c18"><span class="c0">70 </span><span class="c2">Airport </span><span class="c1">= </span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">AirportFrom) </span></p><p class="c18"><span class="c0">71 </span><span class="c2">y</span><span class="c1">&lt;-</span><span class="c5">c</span><span class="c2">() </span></p><p class="c18"><span class="c0">72 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(af)) </span></p><p class="c18"><span class="c0">73 </span><span class="c2">{ </span></p><p class="c18"><span class="c0">74 </span><span class="c2">af[i]</span><span class="c1">=</span><span class="c2">i </span></p><p class="c18"><span class="c0">75 </span><span class="c2">y[i]</span><span class="c1">&lt;-</span><span class="c2">i </span></p><p class="c18"><span class="c0">76 </span><span class="c2">} </span></p><p class="c33"><span class="c0">77 </span><span class="c1">* </span><span class="c2">To extract airline</span><span class="c1">-</span><span class="c2">specific rows for each of the </span><span class="c1">18 </span><span class="c2">airlines, </span><span class="c0">78 </span><span class="c2">we need to put the name of the different airlines in place of X. </span></p><p class="c43"><span class="c0">79 </span></p><p class="c7"><span class="c0">80 </span><span class="c2">mean</span><span class="c1">=</span><span class="c5">summary</span><span class="c2">(y)[</span><span class="c1">4</span><span class="c2">] </span></p><p class="c12"><span class="c0">81 </span><span class="c5">print</span><span class="c2">(mean) </span></p><p class="c12"><span class="c0">82 </span><span class="c2">sd</span><span class="c1">=</span><span class="c5">sd</span><span class="c2">(y) </span></p><p class="c12"><span class="c0">83 </span><span class="c5">print</span><span class="c2">(sd) </span></p><p class="c79"><span class="c0">84 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(af)) </span><span class="c10"># to scale the airports and store in af </span><span class="c0">85 </span><span class="c2">{ </span></p><p class="c12"><span class="c0">86 </span><span class="c2">af[i]</span><span class="c1">=</span><span class="c2">(i</span><span class="c1">-</span><span class="c2">mean)</span><span class="c1">/</span><span class="c2">sd </span></p><p class="c12"><span class="c0">87 </span><span class="c2">} </span></p><p class="c34"><span class="c0">88 </span></p><p class="c21"><span class="c0">89 </span></p><p class="c48"><span class="c0">90 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(af)) </span><span class="c10">#to input scaled airports in the data set </span><span class="c0">91 </span><span class="c2">{ </span></p><p class="c14"><span class="c0">92 </span><span class="c5">for</span><span class="c2">(j in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(CO</span><span class="c1">$</span><span class="c2">AirportFrom)) </span></p><p class="c14"><span class="c0">93 </span><span class="c2">{ </span></p><p class="c14"><span class="c0">94 </span><span class="c5">if</span><span class="c2">(Airport[i] </span><span class="c1">== </span><span class="c2">CO</span><span class="c1">$</span><span class="c2">AirportFrom[j]) </span></p><p class="c14"><span class="c0">95 </span><span class="c2">CO</span><span class="c1">$</span><span class="c2">AirportFrom[j] </span><span class="c1">= </span><span class="c2">af[i] </span></p><p class="c14"><span class="c0">96 </span><span class="c5">if</span><span class="c2">(Airport[i] </span><span class="c1">== </span><span class="c2">CO</span><span class="c1">$</span><span class="c2">AirportTo[j]) </span></p><p class="c14"><span class="c0">97 </span><span class="c2">CO</span><span class="c1">$</span><span class="c2">AirportTo[j] </span><span class="c1">= </span><span class="c2">af[i] </span></p><p class="c14"><span class="c0">98 </span><span class="c2">} </span></p><p class="c14"><span class="c0">99 </span><span class="c2">} </span></p><p class="c6"><span class="c0">100 </span><span class="c2">d</span><span class="c1">=</span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">DayOfWeek) </span><span class="c10">#scaling day of week </span></p><p class="c6"><span class="c0">101 </span><span class="c2">days </span><span class="c1">= </span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">DayOfWeek) </span></p><p class="c6"><span class="c0">102 </span><span class="c2">z</span><span class="c1">&lt;-</span><span class="c5">c</span><span class="c2">() </span></p><p class="c6"><span class="c0">103 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(days)) </span></p><p class="c6"><span class="c0">104 </span><span class="c2">{ </span></p><p class="c6"><span class="c0">105 </span><span class="c2">d[i]</span><span class="c1">=</span><span class="c2">i </span></p><p class="c6"><span class="c0">106 </span><span class="c2">z[i]</span><span class="c1">&lt;-</span><span class="c2">i </span></p><p class="c6"><span class="c0">107 </span><span class="c2">} </span></p><p class="c6"><span class="c0">108 </span><span class="c2">mean1</span><span class="c1">=</span><span class="c5">summary</span><span class="c2">(z)[</span><span class="c1">4</span><span class="c2">] </span></p><p class="c6"><span class="c0">109 </span><span class="c5">print</span><span class="c2">(mean1) </span></p><p class="c6"><span class="c0">110 </span><span class="c2">sd1</span><span class="c1">=</span><span class="c5">sd</span><span class="c2">(z) </span></p><p class="c6"><span class="c0">111 </span><span class="c5">print</span><span class="c2">(sd1) </span></p><p class="c6"><span class="c0">112 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(d)) </span></p><p class="c6"><span class="c0">113 </span><span class="c2">{ </span></p><p class="c6"><span class="c0">114 </span><span class="c2">d[i]</span><span class="c1">=</span><span class="c2">(i</span><span class="c1">-</span><span class="c2">mean1)</span><span class="c1">/</span><span class="c2">sd1 </span></p><p class="c6"><span class="c0">115 </span><span class="c2">} </span></p><p class="c37"><span class="c0">116 </span></p><p class="c11"><span class="c0">117 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(d)) </span><span class="c10">#to input scaled day of week in the dataset </span><span class="c0">118 </span><span class="c2">{ </span></p><p class="c6"><span class="c0">119 </span><span class="c5">for</span><span class="c2">(j in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(CO</span><span class="c1">$</span><span class="c2">DayOfWeek)) </span></p><p class="c6"><span class="c0">120 </span><span class="c2">{ </span></p><p class="c52"><span class="c2"></span></p><p class="c41"><span class="c0">121 </span><span class="c5">if</span><span class="c2">(days[i] </span><span class="c1">== </span><span class="c2">CO</span><span class="c1">$</span><span class="c2">DayOfWeek[j]) </span></p><p class="c6"><span class="c0">122 </span><span class="c2">CO</span><span class="c1">$</span><span class="c2">DayOfWeek[j] </span><span class="c1">= </span><span class="c2">d[i] </span></p><p class="c6"><span class="c0">123 </span><span class="c2">} </span></p><p class="c6"><span class="c0">124 </span><span class="c2">} </span></p><p class="c6"><span class="c0">125 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">head</span><span class="c2">(CO, </span><span class="c1">5</span><span class="c2">)) </span></p><p class="c37"><span class="c0">126 </span></p><p class="c26"><span class="c0">127 </span><span class="c2">del_CO</span><span class="c1">=</span><span class="c2">CO</span><span class="c1">$</span><span class="c2">Delay </span></p><p class="c27"><span class="c0">128 </span><span class="c2">glm.fit </span><span class="c1">= </span><span class="c5">glm</span><span class="c2">(formula </span><span class="c1">= </span><span class="c2">del_CO </span><span class="c1">~ </span><span class="c2">Flight</span><span class="c1">+</span><span class="c2">AirportFrom</span><span class="c1">+</span><span class="c2">AirportTo</span><span class="c1">+</span><span class="c2">DayOfWeek</span><span class="c1">+</span><span class="c2">Time</span><span class="c1">+</span><span class="c2">Length, </span><span class="c0">129 </span><span class="c2">data </span><span class="c1">= </span><span class="c2">CO, family </span><span class="c1">= </span><span class="c2">binomial) </span></p><p class="c6"><span class="c0">130 </span><span class="c10">#print(summary(glm.fit)) </span></p><p class="c6"><span class="c0">131 </span><span class="c2">input</span><span class="c1">=</span><span class="c5">data.matrix</span><span class="c2">(CO[,</span><span class="c5">c</span><span class="c2">(</span><span class="c3">&quot;Flight&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportFrom&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportTo&quot;</span><span class="c2">,</span><span class="c3">&quot;DayOfWeek&quot;</span><span class="c2">,</span><span class="c3">&quot;Time&quot;</span><span class="c2">,</span><span class="c3">&quot;Length&quot;</span><span class="c2">)]) </span></p><p class="c37"><span class="c0">132 </span></p><p class="c26"><span class="c0">133 </span><span class="c5">library</span><span class="c2">(glmnet) </span></p><p class="c6"><span class="c0">134 </span><span class="c5">library</span><span class="c2">(caret) </span></p><p class="c62"><span class="c0">135 </span><span class="c10">#----------------------------------------------------------------------------------- </span><span class="c0">136 </span><span class="c2">x.test </span><span class="c1">=</span><span class="c2">input </span><span class="c10">#Logistic Regression </span></p><p class="c6"><span class="c0">137 </span><span class="c2">p </span><span class="c1">&lt;- </span><span class="c5">predict</span><span class="c2">(glm.fit, newx </span><span class="c1">= </span><span class="c2">x.test, type </span><span class="c1">= </span><span class="c3">&quot;response&quot;</span><span class="c2">) </span></p><p class="c37"><span class="c0">138 </span></p><p class="c36"><span class="c0">139 </span></p><p class="c26"><span class="c0">140 </span><span class="c2">pred </span><span class="c1">= </span><span class="c5">rep</span><span class="c2">(</span><span class="c1">0</span><span class="c2">, </span><span class="c5">dim</span><span class="c2">(input)[</span><span class="c1">1</span><span class="c2">]) </span></p><p class="c6"><span class="c0">141 </span><span class="c2">pred[p</span><span class="c1">&gt; </span><span class="c2">.</span><span class="c1">4616</span><span class="c2">] </span><span class="c1">= 1 </span></p><p class="c6"><span class="c0">142 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO)) </span><span class="c10">#to print confusion matrix </span></p><p class="c22"><span class="c0">143 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">confusionMatrix</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO))) </span><span class="c10">#statistical analysis of confusion matrix </span><span class="c0">144 </span><span class="c10">#----------------------------------------------------------------------- </span><span class="c0">145 </span><span class="c2">cv_model </span><span class="c1">&lt;- </span><span class="c5">cv.glmnet</span><span class="c2">(input, del_CO, family</span><span class="c1">=</span><span class="c3">&quot;binomial&quot;</span><span class="c2">, alpha</span><span class="c1">=0</span><span class="c2">, type.measure </span><span class="c1">= </span><span class="c3">&quot;mse&quot;</span><span class="c2">, </span><span class="c0">146 </span><span class="c2">nfolds </span><span class="c1">= 10</span><span class="c2">) </span><span class="c10">#Ridge </span></p><p class="c6"><span class="c0">147 </span><span class="c2">best_lambda </span><span class="c1">&lt;- </span><span class="c2">cv_model</span><span class="c1">$</span><span class="c2">lambda.min </span></p><p class="c6"><span class="c0">148 </span><span class="c2">best_model_r </span><span class="c1">&lt;- </span><span class="c5">glmnet</span><span class="c2">(input, del_CO, family</span><span class="c1">=</span><span class="c3">&quot;binomial&quot;</span><span class="c2">, alpha </span><span class="c1">= 0</span><span class="c2">, lambda </span><span class="c1">= </span><span class="c2">best_lambda) </span></p><p class="c37"><span class="c0">149 </span></p><p class="c26"><span class="c0">150 </span><span class="c10"># Prediction </span></p><p class="c6"><span class="c0">151 </span><span class="c2">x.test </span><span class="c1">=</span><span class="c2">input </span></p><p class="c6"><span class="c0">152 </span><span class="c2">p </span><span class="c1">&lt;- </span><span class="c5">predict</span><span class="c2">(best_model_r, newx </span><span class="c1">= </span><span class="c2">x.test, type </span><span class="c1">= </span><span class="c3">&quot;response&quot;</span><span class="c2">) </span></p><p class="c6"><span class="c0">153 </span><span class="c2">pred </span><span class="c1">= </span><span class="c5">rep</span><span class="c2">(</span><span class="c1">0</span><span class="c2">, </span><span class="c5">dim</span><span class="c2">(input)[</span><span class="c1">1</span><span class="c2">]) </span></p><p class="c6"><span class="c0">154 </span><span class="c2">pred[p </span><span class="c1">&gt; </span><span class="c2">.</span><span class="c1">0.4616</span><span class="c2">] </span><span class="c1">= 1 </span></p><p class="c6"><span class="c0">155 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO)) </span><span class="c10">#to print confusion matrix </span></p><p class="c32"><span class="c0">156 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">confusionMatrix</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO))) </span><span class="c10">#statistical analysis of confusion matrix </span><span class="c0">157 </span><span class="c10">#---------------------------------------------------------------------------- </span><span class="c0">158 </span><span class="c2">cv_model </span><span class="c1">&lt;- </span><span class="c5">cv.glmnet</span><span class="c2">(input, del_CO, family</span><span class="c1">=</span><span class="c3">&quot;binomial&quot;</span><span class="c2">, alpha</span><span class="c1">=1</span><span class="c2">, type.measure </span><span class="c1">= </span><span class="c3">&quot;mse&quot;</span><span class="c2">, </span><span class="c0">159 </span><span class="c2">nfolds </span><span class="c1">= 10</span><span class="c2">) </span><span class="c10">#Lasso </span></p><p class="c6"><span class="c0">160 </span><span class="c2">best_lambda </span><span class="c1">&lt;- </span><span class="c2">cv_model</span><span class="c1">$</span><span class="c2">lambda.min </span></p><p class="c6"><span class="c0">161 </span><span class="c2">best_model_l </span><span class="c1">&lt;- </span><span class="c5">glmnet</span><span class="c2">(input, del_CO, family</span><span class="c1">=</span><span class="c3">&quot;binomial&quot;</span><span class="c2">, alpha </span><span class="c1">= 1</span><span class="c2">, lambda </span><span class="c1">= </span><span class="c2">best_lambda) </span></p><p class="c37"><span class="c0">162 </span></p><p class="c26"><span class="c0">163 </span><span class="c10"># Prediction </span></p><p class="c6"><span class="c0">164 </span><span class="c2">x.test </span><span class="c1">=</span><span class="c2">input </span></p><p class="c6"><span class="c0">165 </span><span class="c2">p </span><span class="c1">&lt;- </span><span class="c5">predict</span><span class="c2">(best_model_l, newx </span><span class="c1">= </span><span class="c2">x.test, type </span><span class="c1">= </span><span class="c3">&quot;response&quot;</span><span class="c2">) </span></p><p class="c6"><span class="c0">166 </span><span class="c2">pred </span><span class="c1">= </span><span class="c5">rep</span><span class="c2">(</span><span class="c1">0</span><span class="c2">, </span><span class="c5">dim</span><span class="c2">(input)[</span><span class="c1">1</span><span class="c2">]) </span></p><p class="c6"><span class="c0">167 </span><span class="c2">pred[p </span><span class="c1">&gt; </span><span class="c2">.</span><span class="c1">0.4616</span><span class="c2">] </span><span class="c1">= 1 </span></p><p class="c6"><span class="c0">168 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO)) </span><span class="c10">#to print confusion matrix </span></p><p class="c17"><span class="c0">169 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">confusionMatrix</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO))) </span><span class="c10">#statistical analysis of confusion matrix </span><span class="c0">170 </span><span class="c10">#------------------------------------------------------------------------- </span><span class="c0">171 </span><span class="c2">cv_model </span><span class="c1">&lt;- </span><span class="c5">cv.glmnet</span><span class="c2">(input, del_CO, family</span><span class="c1">=</span><span class="c3">&quot;binomial&quot;</span><span class="c2">, alpha</span><span class="c1">=0.5</span><span class="c2">, type.measure </span><span class="c1">= </span><span class="c3">&quot;mse&quot;</span><span class="c2">, </span><span class="c0">172 </span><span class="c2">nfolds </span><span class="c1">= 10</span><span class="c2">) </span><span class="c10">#Elastic Net </span></p><p class="c6"><span class="c0">173 </span><span class="c2">best_lambda </span><span class="c1">&lt;- </span><span class="c2">cv_model</span><span class="c1">$</span><span class="c2">lambda.min </span></p><p class="c6"><span class="c0">174 </span><span class="c2">best_model_en </span><span class="c1">&lt;- </span><span class="c5">glmnet</span><span class="c2">(input, del_CO, family</span><span class="c1">=</span><span class="c3">&quot;binomial&quot;</span><span class="c2">, alpha </span><span class="c1">= 0.5</span><span class="c2">, lambda </span><span class="c1">= </span><span class="c2">best_lambda) </span></p><p class="c37"><span class="c0">175 </span></p><p class="c26"><span class="c0">176 </span><span class="c10"># Prediction </span></p><p class="c6"><span class="c0">177 </span><span class="c2">x.test </span><span class="c1">=</span><span class="c2">input </span></p><p class="c6"><span class="c0">178 </span><span class="c2">p </span><span class="c1">&lt;- </span><span class="c5">predict</span><span class="c2">(best_model_en, newx </span><span class="c1">= </span><span class="c2">x.test, type </span><span class="c1">= </span><span class="c3">&quot;response&quot;</span><span class="c2">) </span></p><p class="c6"><span class="c0">179 </span><span class="c2">pred </span><span class="c1">= </span><span class="c5">rep</span><span class="c2">(</span><span class="c1">0</span><span class="c2">, </span><span class="c5">dim</span><span class="c2">(input)[</span><span class="c1">1</span><span class="c2">]) </span></p><p class="c6"><span class="c0">180 </span><span class="c2">pred[p </span><span class="c1">&gt; </span><span class="c2">.</span><span class="c1">4616</span><span class="c2">] </span><span class="c1">= 1 </span></p><p class="c6"><span class="c0">181 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO)) </span><span class="c10">#to print confusion matrix </span></p><p class="c69"><span class="c2"></span></p><p class="c71"><span class="c0">182 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">confusionMatrix</span><span class="c2">(</span><span class="c5">table</span><span class="c2">(pred, del_CO))) </span><span class="c10">#statistical analysis of confusion matrix </span><span class="c0">183 </span></p><p class="c26"><span class="c0">184 </span></p><p class="c36"><span class="c0">185 </span></p><p class="c26"><span class="c0">186 </span><span class="c2">AIRLINE</span><span class="c1">-</span><span class="c2">SPECIFIC with OPTIMUM THRESHOLD </span></p><p class="c6"><span class="c0">187 </span><span class="c5">library</span><span class="c2">(caret) </span></p><p class="c6"><span class="c0">188 </span><span class="c5">library</span><span class="c2">(glmnet) </span></p><p class="c6"><span class="c0">189 </span><span class="c2">For this part refer [a]. </span></p><p class="c49"><span class="c0">190 </span><span class="c2">CO</span><span class="c1">=</span><span class="c2">x</span><span class="c1">%&gt;%</span><span class="c5">filter</span><span class="c2">(Airline</span><span class="c1">==</span><span class="c3">&quot;X&quot;</span><span class="c2">)</span><span class="c1">* </span><span class="c10">#to extract airline-specific rows </span><span class="c0">191 </span><span class="c2">For this part refer [b]. </span></p><p class="c6"><span class="c0">192 </span><span class="c2">d</span><span class="c1">=</span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">DayOfWeek) </span><span class="c10">#scaling day of week </span></p><p class="c6"><span class="c0">193 </span><span class="c2">days </span><span class="c1">= </span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">DayOfWeek) </span></p><p class="c6"><span class="c0">194 </span><span class="c2">z</span><span class="c1">&lt;-</span><span class="c5">c</span><span class="c2">() </span></p><p class="c6"><span class="c0">195 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(days)) </span></p><p class="c6"><span class="c0">196 </span><span class="c2">{ </span></p><p class="c6"><span class="c0">197 </span><span class="c2">d[i]</span><span class="c1">=</span><span class="c2">i </span></p><p class="c6"><span class="c0">198 </span><span class="c2">z[i]</span><span class="c1">&lt;-</span><span class="c2">i </span></p><p class="c6"><span class="c0">199 </span><span class="c2">} </span></p><p class="c4"><span class="c0">200 </span><span class="c2">mean1</span><span class="c1">=</span><span class="c5">summary</span><span class="c2">(z)[</span><span class="c1">4</span><span class="c2">] </span></p><p class="c4"><span class="c0">201 </span><span class="c5">print</span><span class="c2">(mean1) </span></p><p class="c4"><span class="c0">202 </span><span class="c2">sd1</span><span class="c1">=</span><span class="c5">sd</span><span class="c2">(z) </span></p><p class="c4"><span class="c0">203 </span><span class="c5">print</span><span class="c2">(sd1) </span></p><p class="c4"><span class="c0">204 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(d)) </span></p><p class="c4"><span class="c0">205 </span><span class="c2">{ </span></p><p class="c4"><span class="c0">206 </span><span class="c2">d[i]</span><span class="c1">=</span><span class="c2">(i</span><span class="c1">-</span><span class="c2">mean1)</span><span class="c1">/</span><span class="c2">sd1 </span></p><p class="c4"><span class="c0">207 </span><span class="c2">} </span></p><p class="c19"><span class="c0">208 </span></p><p class="c57"><span class="c0">209 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(d)) </span></p><p class="c4"><span class="c0">210 </span><span class="c2">{ </span></p><p class="c4"><span class="c0">211 </span><span class="c5">for</span><span class="c2">(j in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(AL</span><span class="c1">$</span><span class="c2">DayOfWeek)) </span></p><p class="c4"><span class="c0">212 </span><span class="c2">{ </span></p><p class="c4"><span class="c0">213 </span><span class="c5">if</span><span class="c2">(days[i] </span><span class="c1">== </span><span class="c2">AL</span><span class="c1">$</span><span class="c2">DayOfWeek[j]) </span></p><p class="c4"><span class="c0">214 </span><span class="c2">AL</span><span class="c1">$</span><span class="c2">DayOfWeek[j] </span><span class="c1">= </span><span class="c2">d[i] </span></p><p class="c4"><span class="c0">215 </span><span class="c2">} </span></p><p class="c4"><span class="c0">216 </span><span class="c2">} </span></p><p class="c4"><span class="c0">217 </span><span class="c2">del_CO</span><span class="c1">=</span><span class="c2">CO</span><span class="c1">$</span><span class="c2">Delay </span></p><p class="c59"><span class="c0">218 </span><span class="c2">glm.fit </span><span class="c1">= </span><span class="c5">glm</span><span class="c2">(formula </span><span class="c1">= </span><span class="c2">del_CO </span><span class="c1">~ </span><span class="c2">Flight</span><span class="c1">+</span><span class="c2">AirportFrom</span><span class="c1">+</span><span class="c2">AirportTo</span><span class="c1">+</span><span class="c2">DayOfWeek</span><span class="c1">+</span><span class="c2">Time</span><span class="c1">+</span><span class="c2">Length, </span><span class="c0">219 </span><span class="c2">data</span><span class="c1">= </span><span class="c2">CO, family </span><span class="c1">= </span><span class="c2">binomial) </span></p><p class="c4"><span class="c0">220 </span><span class="c2">input</span><span class="c1">=</span><span class="c5">data.matrix</span><span class="c2">(CO[,</span><span class="c5">c</span><span class="c2">(</span><span class="c3">&quot;Flight&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportFrom&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportTo&quot;</span><span class="c2">,</span><span class="c3">&quot;DayOfWeek&quot;</span><span class="c2">,</span><span class="c3">&quot;Time&quot;</span><span class="c2">,</span><span class="c3">&quot;Length&quot;</span><span class="c2">)]) </span></p><p class="c19"><span class="c0">221 </span></p><p class="c57"><span class="c0">222 </span><span class="c2">[c] </span></p><p class="c4"><span class="c0">223 </span><span class="c2">spec </span><span class="c1">= 0 </span></p><p class="c4"><span class="c0">224 </span><span class="c2">sens </span><span class="c1">= 0 </span></p><p class="c4"><span class="c0">225 </span><span class="c2">j </span><span class="c1">= 1 </span></p><p class="c4"><span class="c0">226 </span><span class="c2">i </span><span class="c1">= 0.30 </span></p><p class="c4"><span class="c0">227 </span><span class="c2">ran </span><span class="c1">= 0 </span></p><p class="c4"><span class="c0">228 </span><span class="c2">diff </span></p><p class="c65"><span class="c0">229 </span><span class="c5">while</span><span class="c2">(i </span><span class="c1">&lt; 0.81</span><span class="c2">) </span><span class="c10">#to find optimum threshold for decent sensitivity and specificity </span><span class="c0">230 </span><span class="c2">{ </span></p><p class="c4"><span class="c0">231 </span><span class="c2">ran[j] </span><span class="c1">= </span><span class="c2">i </span></p><p class="c4"><span class="c0">232 </span><span class="c2">x.test </span><span class="c1">=</span><span class="c2">input </span><span class="c10">#Logistic Regression </span></p><p class="c4"><span class="c0">233 </span><span class="c2">p </span><span class="c1">&lt;- </span><span class="c5">predict</span><span class="c2">(glm.fit, newx </span><span class="c1">= </span><span class="c2">x.test, type </span><span class="c1">= </span><span class="c3">&quot;response&quot;</span><span class="c2">) </span></p><p class="c4"><span class="c0">234 </span><span class="c2">pred </span><span class="c1">= </span><span class="c5">rep</span><span class="c2">(</span><span class="c1">0</span><span class="c2">, </span><span class="c5">dim</span><span class="c2">(input)[</span><span class="c1">1</span><span class="c2">]) </span></p><p class="c4"><span class="c0">235 </span><span class="c2">pred[p</span><span class="c1">&gt;</span><span class="c2">i]</span><span class="c1">=1 </span></p><p class="c4"><span class="c0">236 </span><span class="c2">conf_mat </span><span class="c1">= </span><span class="c5">table</span><span class="c2">(pred, del_CO_Day) </span></p><p class="c4"><span class="c0">237 </span><span class="c10">#conf_mat </span></p><p class="c4"><span class="c0">238 </span><span class="c2">spec[j] </span><span class="c1">= </span><span class="c5">specificity</span><span class="c2">(conf_mat) </span></p><p class="c4"><span class="c0">239 </span><span class="c2">sens[j] </span><span class="c1">= </span><span class="c5">sensitivity</span><span class="c2">(conf_mat) </span></p><p class="c4"><span class="c0">240 </span><span class="c2">diff[j] </span><span class="c1">= </span><span class="c5">abs</span><span class="c2">(spec[j] </span><span class="c1">- </span><span class="c2">sens[j]) </span></p><p class="c4"><span class="c0">241 </span><span class="c2">j </span><span class="c1">= </span><span class="c2">j </span><span class="c1">+ 1 </span></p><p class="c4"><span class="c0">242 </span><span class="c2">i </span><span class="c1">= </span><span class="c2">i </span><span class="c1">+ 0.01 </span></p><p class="c40"><span class="c2"></span></p><p class="c23"><span class="c0">243 </span><span class="c2">} </span></p><p class="c4"><span class="c0">244 </span><span class="c2">ran </span></p><p class="c47"><span class="c0">245 </span><span class="c2">df </span><span class="c1">&lt;- </span><span class="c5">data.frame</span><span class="c2">(spec, sens) </span><span class="c10">#plotting sensitivity and specificity </span><span class="c0">246 </span><span class="c5">require</span><span class="c2">(ggplot2) </span></p><p class="c4"><span class="c0">247 </span><span class="c2">g </span><span class="c1">&lt;- </span><span class="c5">ggplot</span><span class="c2">(df, </span><span class="c5">aes</span><span class="c2">(spec)) </span></p><p class="c4"><span class="c0">248 </span><span class="c2">g </span><span class="c1">&lt;- </span><span class="c2">g </span><span class="c1">+ </span><span class="c5">geom_line</span><span class="c2">(</span><span class="c5">aes</span><span class="c2">(y</span><span class="c1">=</span><span class="c2">sens), colour</span><span class="c1">=</span><span class="c3">&quot;red&quot;</span><span class="c2">) </span></p><p class="c4"><span class="c0">249 </span><span class="c2">g </span><span class="c1">&lt;- </span><span class="c2">g </span><span class="c1">+ </span><span class="c5">geom_line</span><span class="c2">(</span><span class="c5">aes</span><span class="c2">(y</span><span class="c1">=</span><span class="c2">spec), colour</span><span class="c1">=</span><span class="c3">&quot;green&quot;</span><span class="c2">) </span><span class="c1">+</span><span class="c5">xlim</span><span class="c2">(</span><span class="c1">0</span><span class="c2">,</span><span class="c1">1</span><span class="c2">) </span></p><p class="c4"><span class="c0">250 </span><span class="c2">g </span></p><p class="c4"><span class="c0">251 </span><span class="c2">diff </span></p><p class="c42"><span class="c0">252 </span><span class="c5">min</span><span class="c2">(diff) </span><span class="c10">#finding the minimum difference between sensitivity and specificity </span><span class="c0">253 </span><span class="c2">m </span><span class="c1">= </span><span class="c5">min</span><span class="c2">(diff) </span></p><p class="c4"><span class="c0">254 </span><span class="c2">k </span><span class="c1">= </span><span class="c5">which</span><span class="c2">(diff </span><span class="c1">== </span><span class="c2">m) </span></p><p class="c4"><span class="c0">255 </span><span class="c2">ran[k] </span><span class="c10">#the optimum threshold value </span></p><p class="c4"><span class="c0">256 </span><span class="c2">x.test </span><span class="c1">=</span><span class="c2">input </span><span class="c10">#Verification of optimum threshold value </span></p><p class="c4"><span class="c0">257 </span><span class="c2">p </span><span class="c1">&lt;- </span><span class="c5">predict</span><span class="c2">(glm.fit, newx </span><span class="c1">= </span><span class="c2">x.test, type </span><span class="c1">= </span><span class="c3">&quot;response&quot;</span><span class="c2">) </span></p><p class="c4"><span class="c0">258 </span><span class="c2">pred </span><span class="c1">= </span><span class="c5">rep</span><span class="c2">(</span><span class="c1">0</span><span class="c2">, </span><span class="c5">dim</span><span class="c2">(input)[</span><span class="c1">1</span><span class="c2">]) </span></p><p class="c4"><span class="c0">259 </span><span class="c2">pred[p</span><span class="c1">&gt;</span><span class="c2">ran[k]]</span><span class="c1">=1 </span></p><p class="c19"><span class="c0">260 </span></p><p class="c57"><span class="c0">261 </span><span class="c2">[d] </span></p><p class="c46"><span class="c0">262 </span><span class="c2">conf_mat </span><span class="c1">= </span><span class="c5">table</span><span class="c2">(pred, del_CO_Day) </span><span class="c10">#computing confusion matrix </span><span class="c0">263 </span><span class="c5">specificity</span><span class="c2">(conf_mat) </span></p><p class="c4"><span class="c0">264 </span><span class="c5">sensitivity</span><span class="c2">(conf_mat) </span></p><p class="c19"><span class="c0">265 </span></p><p class="c57"><span class="c0">266 </span><span class="c2">DAY</span><span class="c1">-</span><span class="c2">AIRLINE SPECIFIC</span><span class="c1">: </span></p><p class="c4"><span class="c0">267 </span><span class="c2">For this part refer [a] . </span></p><p class="c4"><span class="c0">268 </span><span class="c2">CO</span><span class="c1">=</span><span class="c2">x</span><span class="c1">%&gt;%</span><span class="c5">filter</span><span class="c2">(Airline</span><span class="c1">==</span><span class="c3">&quot;X&quot;</span><span class="c2">)</span><span class="c1">* </span></p><p class="c4"><span class="c0">269 </span><span class="c2">For this part refer [b] . </span></p><p class="c73"><span class="c0">270 </span><span class="c2">CO_Day</span><span class="c1">=</span><span class="c2">CO</span><span class="c1">%&gt;%</span><span class="c5">filter</span><span class="c2">(DayOfWeek</span><span class="c1">==</span><span class="c3">&quot;Y&quot;</span><span class="c2">)</span><span class="c1">** </span><span class="c10">#to extract day-specific rows for each airline </span><span class="c0">271 </span><span class="c2">glm.fit </span><span class="c1">= </span><span class="c5">glm</span><span class="c2">(formula </span><span class="c1">= </span><span class="c2">del_CO_Day </span><span class="c1">~ </span><span class="c2">Flight</span><span class="c1">+</span><span class="c2">AirportFrom</span><span class="c1">+</span><span class="c2">AirportTo</span><span class="c1">+</span><span class="c2">DayOfWeek</span><span class="c1">+</span><span class="c2">Time</span><span class="c1">+</span><span class="c2">Length, </span><span class="c0">272 </span><span class="c2">data </span><span class="c1">= </span><span class="c2">CO_Day, family </span><span class="c1">= </span><span class="c2">binomial) </span></p><p class="c39"><span class="c0">273 </span><span class="c2">input</span><span class="c1">=</span><span class="c5">data.matrix</span><span class="c2">(CO_Day[,</span><span class="c5">c</span><span class="c2">(</span><span class="c3">&quot;Flight&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportFrom&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportTo&quot;</span><span class="c2">,</span><span class="c3">&quot;DayOfWeek&quot;</span><span class="c2">,</span><span class="c3">&quot;Time&quot;</span><span class="c2">,</span><span class="c3">&quot;Length&quot;</span><span class="c2">)]) </span><span class="c0">274 </span><span class="c2">For this part refer [c] . </span></p><p class="c4"><span class="c0">275 </span><span class="c2">For this part refer [d] . </span></p><p class="c19"><span class="c0">276 </span></p><p class="c57"><span class="c0">277 </span><span class="c2">DAY SPECIFIC</span><span class="c1">: </span></p><p class="c19"><span class="c0">278 </span></p><p class="c57"><span class="c0">279 </span><span class="c2">For this part refer [a]. </span></p><p class="c4"><span class="c0">280 </span><span class="c2">DW</span><span class="c1">=</span><span class="c2">x</span><span class="c1">%&gt;%</span><span class="c5">filter</span><span class="c2">(DayOfWeek</span><span class="c1">==</span><span class="c3">&quot;Z&quot;</span><span class="c2">)</span><span class="c1">*** </span><span class="c10">#to extract day-specific rows </span></p><p class="c4"><span class="c0">281 </span><span class="c2">For this part refer [b](DW in place of CO) </span></p><p class="c4"><span class="c0">282 </span><span class="c2">d</span><span class="c1">=</span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">Airline) </span></p><p class="c4"><span class="c0">283 </span><span class="c2">airl </span><span class="c1">= </span><span class="c5">unique</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">Airline) </span></p><p class="c4"><span class="c0">284 </span><span class="c2">z</span><span class="c1">&lt;-</span><span class="c5">c</span><span class="c2">() </span></p><p class="c4"><span class="c0">285 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(airl)) </span></p><p class="c4"><span class="c0">286 </span><span class="c2">{ </span></p><p class="c4"><span class="c0">287 </span><span class="c2">d[i]</span><span class="c1">=</span><span class="c2">i </span></p><p class="c4"><span class="c0">288 </span><span class="c2">z[i]</span><span class="c1">&lt;-</span><span class="c2">i </span></p><p class="c4"><span class="c0">289 </span><span class="c2">} </span></p><p class="c66"><span class="c0">290 </span></p><p class="c51"><span class="c0">291 </span><span class="c1">**</span><span class="c2">To extract day</span><span class="c1">-</span><span class="c2">specific rows for each airline, we need to put the day of week for each </span><span class="c0">292 </span><span class="c2">airline in place of Y. </span></p><p class="c44"><span class="c0">293 </span><span class="c1">***</span><span class="c2">To extract day</span><span class="c1">-</span><span class="c2">specific rows, we need to put the day of week in place of Z </span></p><p class="c66"><span class="c0">294 </span></p><p class="c61"><span class="c0">295 </span><span class="c2">mean1</span><span class="c1">=</span><span class="c5">summary</span><span class="c2">(z)[</span><span class="c1">4</span><span class="c2">] </span></p><p class="c44"><span class="c0">296 </span><span class="c5">print</span><span class="c2">(mean1) </span></p><p class="c44"><span class="c0">297 </span><span class="c2">sd1</span><span class="c1">=</span><span class="c5">sd</span><span class="c2">(z) </span></p><p class="c44"><span class="c0">298 </span><span class="c5">print</span><span class="c2">(sd1) </span></p><p class="c44"><span class="c0">299 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(d)) </span><span class="c10">#scaling airline </span></p><p class="c8"><span class="c0">300 </span><span class="c2">{ </span></p><p class="c8"><span class="c0">301 </span><span class="c2">d[i]</span><span class="c1">=</span><span class="c2">(i</span><span class="c1">-</span><span class="c2">mean1)</span><span class="c1">/</span><span class="c2">sd1 </span></p><p class="c8"><span class="c0">302 </span><span class="c2">} </span></p><p class="c8"><span class="c0">303 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(d)) </span><span class="c10">#to input scaled airline in the dataset </span></p><p class="c24"><span class="c2"></span></p><p class="c64"><span class="c0">304 </span><span class="c2">{ </span></p><p class="c8"><span class="c0">305 </span><span class="c5">for</span><span class="c2">(j in </span><span class="c1">1:</span><span class="c5">length</span><span class="c2">(DW</span><span class="c1">$</span><span class="c2">Airline)) </span></p><p class="c8"><span class="c0">306 </span><span class="c2">{ </span></p><p class="c8"><span class="c0">307 </span><span class="c5">if</span><span class="c2">(airl[i] </span><span class="c1">== </span><span class="c2">DW</span><span class="c1">$</span><span class="c2">Airline[j]) </span></p><p class="c8"><span class="c0">308 </span><span class="c2">DW</span><span class="c1">$</span><span class="c2">Airline[j] </span><span class="c1">= </span><span class="c2">d[i] </span></p><p class="c8"><span class="c0">309 </span><span class="c2">} </span></p><p class="c8"><span class="c0">310 </span><span class="c2">} </span></p><p class="c8"><span class="c0">311 </span><span class="c2">del_DW </span><span class="c1">= </span><span class="c2">DW</span><span class="c1">$</span><span class="c2">Delay </span></p><p class="c72"><span class="c0">312 </span><span class="c2">glm.fit </span><span class="c1">= </span><span class="c5">glm</span><span class="c2">(formula </span><span class="c1">= </span><span class="c2">del_DW </span><span class="c1">~ </span><span class="c2">Airline</span><span class="c1">+</span><span class="c2">Flight</span><span class="c1">+</span><span class="c2">AirportFrom</span><span class="c1">+</span><span class="c2">AirportTo</span><span class="c1">+</span><span class="c2">Time</span><span class="c1">+</span><span class="c2">Length, data </span><span class="c1">= </span><span class="c2">DW, </span><span class="c0">313 </span><span class="c2">family </span><span class="c1">= </span><span class="c2">binomial) </span><span class="c0">314 </span><span class="c2">input</span><span class="c1">=</span><span class="c5">data.matrix</span><span class="c2">(DW[,</span><span class="c5">c</span><span class="c2">(</span><span class="c3">&quot;Airline&quot;</span><span class="c2">,</span><span class="c3">&quot;Flight&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportFrom&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportTo&quot;</span><span class="c2">,</span><span class="c3">&quot;Time&quot;</span><span class="c2">,</span><span class="c3">&quot;Length&quot;</span><span class="c2">)]) </span><span class="c0">315 </span><span class="c2">For this part refer [c]. </span></p><p class="c8"><span class="c0">316 </span><span class="c2">conf_mat </span><span class="c1">= </span><span class="c5">table</span><span class="c2">(pred, del_DW) </span><span class="c10">#computing confusion matrix </span></p><p class="c8"><span class="c0">317 </span><span class="c5">specificity</span><span class="c2">(conf_mat) </span></p><p class="c8"><span class="c0">318 </span><span class="c5">sensitivity</span><span class="c2">(conf_mat) </span></p><p class="c20"><span class="c0">319 </span></p><p class="c13"><span class="c0">320 </span><span class="c2">CLUSTERING</span><span class="c1">: </span></p><p class="c20"><span class="c0">321 </span></p><p class="c13"><span class="c0">322 </span><span class="c2">For this part refer [a] . </span></p><p class="c74"><span class="c0">323 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">Airline </span><span class="c1">= </span><span class="c5">scale</span><span class="c2">(</span><span class="c5">as.numeric</span><span class="c2">(</span><span class="c5">as.factor</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">Airline))) </span><span class="c10">#scaling each column of the dataset </span><span class="c0">324 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">AirportFrom </span><span class="c1">= </span><span class="c5">scale</span><span class="c2">(</span><span class="c5">as.numeric</span><span class="c2">(</span><span class="c5">as.factor</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">AirportFrom))) </span></p><p class="c8"><span class="c0">325 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">AirportTo </span><span class="c1">= </span><span class="c5">scale</span><span class="c2">(</span><span class="c5">as.numeric</span><span class="c2">(</span><span class="c5">as.factor</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">AirportTo))) </span></p><p class="c20"><span class="c0">326 </span></p><p class="c9"><span class="c0">327 </span></p><p class="c13"><span class="c0">328 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">DayOfWeek </span><span class="c1">= </span><span class="c5">scale</span><span class="c2">(</span><span class="c5">as.numeric</span><span class="c2">(</span><span class="c5">as.factor</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">DayOfWeek))) </span></p><p class="c8"><span class="c0">329 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">Time </span><span class="c1">= </span><span class="c5">scale</span><span class="c2">(</span><span class="c5">as.numeric</span><span class="c2">(</span><span class="c5">as.factor</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">Time))) </span></p><p class="c8"><span class="c0">330 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">Length </span><span class="c1">= </span><span class="c5">scale</span><span class="c2">(</span><span class="c5">as.numeric</span><span class="c2">(</span><span class="c5">as.factor</span><span class="c2">(x</span><span class="c1">$</span><span class="c2">Length))) </span></p><p class="c8"><span class="c0">331 </span><span class="c5">tail</span><span class="c2">(x,</span><span class="c1">5</span><span class="c2">) </span></p><p class="c8"><span class="c0">332 </span><span class="c5">set.seed</span><span class="c2">(</span><span class="c1">123</span><span class="c2">) </span></p><p class="c8"><span class="c0">333 </span><span class="c10"># Compute and plot wss for k = 2 to k = 15. </span></p><p class="c8"><span class="c0">334 </span><span class="c2">k.max </span><span class="c1">&lt;- 15 </span></p><p class="c77"><span class="c0">335 </span><span class="c2">wss </span><span class="c1">&lt;- </span><span class="c5">sapply</span><span class="c2">(</span><span class="c1">1:</span><span class="c2">k.max,</span><span class="c5">function</span><span class="c2">(k){</span><span class="c5">kmeans</span><span class="c2">(x, k, nstart</span><span class="c1">=50</span><span class="c2">,iter.max </span><span class="c1">= 15 </span><span class="c2">)</span><span class="c1">$</span><span class="c2">tot.withinss}) </span><span class="c0">336 </span><span class="c2">wss </span></p><p class="c58"><span class="c0">337 </span><span class="c5">plot</span><span class="c2">(</span><span class="c1">1:</span><span class="c2">k.max, wss,type</span><span class="c1">=</span><span class="c3">&quot;b&quot;</span><span class="c2">, pch </span><span class="c1">= 19</span><span class="c2">, frame </span><span class="c1">= </span><span class="c55">FALSE</span><span class="c2">,xlab</span><span class="c1">=</span><span class="c3">&quot;Number of clusters K&quot;</span><span class="c2">, </span><span class="c0">338 </span><span class="c2">ylab</span><span class="c1">=</span><span class="c3">&quot;Total within-clusters sum of squares&quot;</span><span class="c2">) </span></p><p class="c15"><span class="c0">339 </span><span class="c10">#plot to calculate the optimum number of clusters </span><span class="c0">340 </span><span class="c5">options</span><span class="c2">(max.print</span><span class="c1">=</span><span class="c3">&quot;5000000&quot;</span><span class="c2">) </span></p><p class="c8"><span class="c0">341 </span><span class="c5">library</span><span class="c2">(factoextra) </span></p><p class="c8"><span class="c0">342 </span><span class="c2">km.res </span><span class="c1">= </span><span class="c5">kmeans</span><span class="c2">(x, </span><span class="c1">4</span><span class="c2">, nstart </span><span class="c1">= 50</span><span class="c2">) </span></p><p class="c8"><span class="c0">343 </span><span class="c5">print</span><span class="c2">(</span><span class="c5">tail</span><span class="c2">(km.res</span><span class="c1">$</span><span class="c2">cluster,</span><span class="c1">5</span><span class="c2">)) </span></p><p class="c8"><span class="c0">344 </span><span class="c5">fviz_cluster</span><span class="c2">(km.res, x, ellipse.type </span><span class="c1">= </span><span class="c3">&quot;norm&quot;</span><span class="c2">) </span><span class="c10">#cluster plot </span></p><p class="c75"><span class="c0">345 </span><span class="c5">for</span><span class="c2">(i in </span><span class="c1">1:322765</span><span class="c2">) </span><span class="c10">#input a separate row for cluster no. in the dataset </span><span class="c0">346 </span><span class="c2">{ </span></p><p class="c8"><span class="c0">347 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">ClusterNo[i] </span><span class="c1">= </span><span class="c2">km.res</span><span class="c1">$</span><span class="c2">cluster[i] </span></p><p class="c8"><span class="c0">348 </span><span class="c2">x</span><span class="c1">$</span><span class="c2">Delay[i] </span><span class="c1">= </span><span class="c2">y[i] </span></p><p class="c8"><span class="c0">349 </span><span class="c2">} </span></p><p class="c8"><span class="c0">350 </span><span class="c5">tail</span><span class="c2">(x,</span><span class="c1">5</span><span class="c2">) </span></p><p class="c25"><span class="c0">351 </span><span class="c2">Cl</span><span class="c1">=</span><span class="c2">x</span><span class="c1">%&gt;%</span><span class="c5">filter</span><span class="c2">(ClusterNo</span><span class="c1">==</span><span class="c3">&quot;N&quot;</span><span class="c2">)</span><span class="c1">**** </span><span class="c10">#to extract cluster no. specific rows </span><span class="c0">352 </span><span class="c2">del_Cl</span><span class="c1">=</span><span class="c2">Cl</span><span class="c1">$</span><span class="c2">Delay </span></p><p class="c50"><span class="c0">353 </span><span class="c2">glm.fit </span><span class="c1">= </span><span class="c5">glm</span><span class="c2">(formula </span><span class="c1">= </span><span class="c2">del_Cl </span><span class="c1">~ </span><span class="c2">Airline</span><span class="c1">+</span><span class="c2">Flight</span><span class="c1">+</span><span class="c2">AirportFrom</span><span class="c1">+</span><span class="c2">AirportTo</span><span class="c1">+</span><span class="c2">DayOfWeek</span><span class="c1">+</span><span class="c2">Time</span><span class="c1">+</span><span class="c2">Length, </span><span class="c0">354 </span><span class="c2">data </span><span class="c1">= </span><span class="c2">Cl, family </span><span class="c1">= </span><span class="c2">binomial) </span></p><p class="c80"><span class="c0">355 </span><span class="c2">input</span><span class="c1">=</span><span class="c5">data.matrix</span><span class="c2">(Cl[,</span><span class="c5">c</span><span class="c2">(</span><span class="c3">&quot;Airline&quot;</span><span class="c2">,</span><span class="c3">&quot;Flight&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportFrom&quot;</span><span class="c2">,</span><span class="c3">&quot;AirportTo&quot;</span><span class="c2">,</span><span class="c3">&quot;DayOfWeek&quot;</span><span class="c2">,</span><span class="c3">&quot;Time&quot;</span><span class="c2">,</span><span class="c3">&quot;Length&quot;</span><span class="c2">)]) </span><span class="c0">356 </span><span class="c1">****</span><span class="c2">To extract cluster no.</span><span class="c1">-</span><span class="c2">specific rows, we need to put the cluster no. in place of N. </span></p><p class="c20"><span class="c0">357 </span></p><p class="c9"><span class="c0">358 </span></p><p class="c13"><span class="c0">359 </span><span class="c10">#For this part refer [c]. </span></p><p class="c8"><span class="c0">360 </span><span class="c2">conf_mat </span><span class="c1">= </span><span class="c5">table</span><span class="c2">(pred, del_Cl) </span><span class="c10">#computing confusion matrix </span></p><p class="c8"><span class="c0">361 </span><span class="c5">specificity</span><span class="c2">(conf_mat) </span></p><p class="c8"><span class="c0">362 </span><span class="c5">sensitivity</span><span class="c2">(conf_mat) </span></p><p class="c20"><span class="c0">363 </span></p></body></html>
